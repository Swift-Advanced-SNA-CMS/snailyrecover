<!DOCTYPE html>
<html lang="en" class="dark">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SnailyCAD Manual Recovery Commands</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
        tailwind.config = {
            darkMode: 'class',
        }
    </script>
    <style>
        .copy-btn {
            opacity: 0;
            transition: opacity 0.2s;
        }
        .code-block:hover .copy-btn {
            opacity: 1;
        }
        .code-block {
            position: relative;
        }
        
        .tab-button.active {
            background-color: rgb(59 130 246);
            color: white;
        }
        
        .scrollspy-active {
            background-color: rgb(59 130 246 / 0.1);
            border-left: 3px solid rgb(59 130 246);
        }
    </style>
</head>
<body class="bg-gray-900 text-gray-100">
    <!-- Navigation -->
    <nav class="bg-gray-800 border-b border-gray-700 sticky top-0 z-50">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="flex justify-between h-16">
                <div class="flex items-center">
                    <div class="flex-shrink-0">
                        <h1 class="text-xl font-semibold text-white">SnailyCAD Manual Recovery Commands</h1>
                    </div>
                </div>
                <div class="flex items-center space-x-4">
                    <button onclick="showPage('unix')" id="unix-tab" class="tab-button px-4 py-2 rounded-md text-sm font-medium bg-blue-600 text-white">
                        Unix/Linux/macOS
                    </button>
                    <button onclick="showPage('windows')" id="windows-tab" class="tab-button px-4 py-2 rounded-md text-sm font-medium text-gray-300 hover:text-white hover:bg-gray-700">
                        Windows
                    </button>
                </div>
            </div>
        </div>
    </nav>

    <div class="flex">
        <!-- Sidebar -->
        <aside class="w-64 bg-gray-800 border-r border-gray-700 h-screen sticky top-16 overflow-y-auto">
            <nav class="mt-5 px-2">
                <div class="space-y-1">
                    <a href="#setup" class="sidebar-link text-gray-300 hover:bg-gray-700 hover:text-white group flex items-center px-2 py-2 text-sm font-medium rounded-md">
                        Database Setup
                    </a>
                    <a href="#list-users" class="sidebar-link text-gray-300 hover:bg-gray-700 hover:text-white group flex items-center px-2 py-2 text-sm font-medium rounded-md">
                        List Users
                    </a>
                    <a href="#unlink-discord" class="sidebar-link text-gray-300 hover:bg-gray-700 hover:text-white group flex items-center px-2 py-2 text-sm font-medium rounded-md">
                        Unlink Discord
                    </a>
                    <a href="#disable-whitelist" class="sidebar-link text-gray-300 hover:bg-gray-700 hover:text-white group flex items-center px-2 py-2 text-sm font-medium rounded-md">
                        Disable Whitelist
                    </a>
                    <a href="#login-features" class="sidebar-link text-gray-300 hover:bg-gray-700 hover:text-white group flex items-center px-2 py-2 text-sm font-medium rounded-md">
                        Login Features
                    </a>
                    <a href="#reset-passwords" class="sidebar-link text-gray-300 hover:bg-gray-700 hover:text-white group flex items-center px-2 py-2 text-sm font-medium rounded-md">
                        Reset Passwords
                    </a>
                    <a href="#maintenance" class="sidebar-link text-gray-300 hover:bg-gray-700 hover:text-white group flex items-center px-2 py-2 text-sm font-medium rounded-md">
                        Maintenance
                    </a>
                </div>
            </nav>
        </aside>

        <!-- Main Content -->
        <main class="flex-1 px-4 py-6 lg:px-8">
            <!-- Unix/Linux/macOS Commands -->
            <div id="unix-content" class="max-w-7xl mx-auto">
                <div class="mb-8">
                    <h1 class="text-3xl font-bold text-white mb-4">SnailyCAD Manual Recovery - Unix/Linux/macOS</h1>
                    <p class="text-gray-300 text-lg">Step-by-step manual commands for SnailyCAD database recovery and administration</p>
                </div>

                <!-- Database Setup -->
                <section id="setup" class="mb-12">
                    <h2 class="text-2xl font-semibold text-white mb-4">Database Connection Setup</h2>
                    
                    <div class="space-y-6">
                        <div class="bg-gray-800 p-6 rounded-lg border border-gray-700">
                            <h3 class="text-xl font-semibold text-white mb-4">Step 1: Find PostgreSQL Installation</h3>
                            <div class="code-block">
                                <div class="bg-gray-900 rounded-lg p-4 relative">
                                    <pre class="text-green-400 text-sm overflow-x-auto"><code># Check if psql is in PATH
which psql

# Find PostgreSQL installation
find /usr -name "psql" 2>/dev/null
find /opt -name "psql" 2>/dev/null
find /Applications -name "psql" 2>/dev/null

# Common locations
ls -la /usr/bin/psql
ls -la /usr/local/bin/psql
ls -la /opt/postgresql/bin/psql</code></pre>
                                    <button onclick="copyToClipboard(this.previousElementSibling.textContent)" class="copy-btn absolute top-2 right-2 bg-blue-600 text-white px-3 py-1 rounded text-sm hover:bg-blue-700">
                                        Copy
                                    </button>
                                </div>
                            </div>
                        </div>

                        <div class="bg-gray-800 p-6 rounded-lg border border-gray-700">
                            <h3 class="text-xl font-semibold text-white mb-4">Step 2: Set Environment Variables</h3>
                            <div class="code-block">
                                <div class="bg-gray-900 rounded-lg p-4 relative">
                                    <pre class="text-green-400 text-sm overflow-x-auto"><code># Set database connection details
export PGHOST="localhost"
export PGPORT="5432"
export PGUSER="postgres"
export PGDATABASE="snaily-cad-v4"
export PGPASSWORD="your_password_here"</code></pre>
                                    <button onclick="copyToClipboard(this.previousElementSibling.textContent)" class="copy-btn absolute top-2 right-2 bg-blue-600 text-white px-3 py-1 rounded text-sm hover:bg-blue-700">
                                        Copy
                                    </button>
                                </div>
                            </div>
                        </div>

                        <div class="bg-gray-800 p-6 rounded-lg border border-gray-700">
                            <h3 class="text-xl font-semibold text-white mb-4">Step 3: Test Database Connection</h3>
                            <div class="code-block">
                                <div class="bg-gray-900 rounded-lg p-4 relative">
                                    <pre class="text-green-400 text-sm overflow-x-auto"><code># Test connection
psql -c "SELECT 1;"

# Alternative with full connection string
psql -U postgres -d snaily-cad-v4 -h localhost -p 5432 -c "SELECT version();"</code></pre>
                                    <button onclick="copyToClipboard(this.previousElementSibling.textContent)" class="copy-btn absolute top-2 right-2 bg-blue-600 text-white px-3 py-1 rounded text-sm hover:bg-blue-700">
                                        Copy
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>
                </section>

                <!-- List Users -->
                <section id="list-users" class="mb-12">
                    <h2 class="text-2xl font-semibold text-white mb-4">1. List All Users</h2>
                    <div class="bg-gray-800 p-6 rounded-lg border border-gray-700">
                        <p class="text-gray-300 mb-4">Display all users with their information:</p>
                        <div class="code-block">
                            <div class="bg-gray-900 rounded-lg p-4 relative">
                                <pre class="text-blue-400 text-sm overflow-x-auto"><code>psql -c "SELECT row_number() OVER () AS num, id, username, \"discordId\" FROM public.\"User\" ORDER BY username;"</code></pre>
                                <button onclick="copyToClipboard(this.previousElementSibling.textContent)" class="copy-btn absolute top-2 right-2 bg-blue-600 text-white px-3 py-1 rounded text-sm hover:bg-blue-700">
                                    Copy
                                </button>
                            </div>
                        </div>
                        
                        <div class="mt-4">
                            <h4 class="text-white font-semibold mb-2">Alternative: Show only users with Discord IDs</h4>
                            <div class="code-block">
                                <div class="bg-gray-900 rounded-lg p-4 relative">
                                    <pre class="text-blue-400 text-sm overflow-x-auto"><code>psql -c "SELECT username, \"discordId\" FROM public.\"User\" WHERE \"discordId\" IS NOT NULL;"</code></pre>
                                    <button onclick="copyToClipboard(this.previousElementSibling.textContent)" class="copy-btn absolute top-2 right-2 bg-blue-600 text-white px-3 py-1 rounded text-sm hover:bg-blue-700">
                                        Copy
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>
                </section>

                <!-- Unlink Discord -->
                <section id="unlink-discord" class="mb-12">
                    <h2 class="text-2xl font-semibold text-white mb-4">2. Unlink Discord ID</h2>
                    <div class="bg-gray-800 p-6 rounded-lg border border-gray-700">
                        <div class="space-y-4">
                            <div>
                                <h4 class="text-white font-semibold mb-2">Step 1: Find user by Discord ID</h4>
                                <div class="code-block">
                                    <div class="bg-gray-900 rounded-lg p-4 relative">
                                        <pre class="text-blue-400 text-sm overflow-x-auto"><code>psql -c "SELECT id, username, \"discordId\" FROM public.\"User\" WHERE \"discordId\" = 'REPLACE_WITH_DISCORD_ID';"</code></pre>
                                        <button onclick="copyToClipboard(this.previousElementSibling.textContent)" class="copy-btn absolute top-2 right-2 bg-blue-600 text-white px-3 py-1 rounded text-sm hover:bg-blue-700">
                                            Copy
                                        </button>
                                    </div>
                                </div>
                            </div>
                            
                            <div>
                                <h4 class="text-white font-semibold mb-2">Step 2: Unlink the Discord ID</h4>
                                <div class="code-block">
                                    <div class="bg-gray-900 rounded-lg p-4 relative">
                                        <pre class="text-blue-400 text-sm overflow-x-auto"><code>psql -c "UPDATE public.\"User\" SET \"discordId\" = NULL WHERE \"discordId\" = 'REPLACE_WITH_DISCORD_ID';"</code></pre>
                                        <button onclick="copyToClipboard(this.previousElementSibling.textContent)" class="copy-btn absolute top-2 right-2 bg-blue-600 text-white px-3 py-1 rounded text-sm hover:bg-blue-700">
                                            Copy
                                        </button>
                                    </div>
                                </div>
                            </div>
                            
                            <div>
                                <h4 class="text-white font-semibold mb-2">Step 3: Verify users without Discord ID</h4>
                                <div class="code-block">
                                    <div class="bg-gray-900 rounded-lg p-4 relative">
                                        <pre class="text-blue-400 text-sm overflow-x-auto"><code>psql -c "SELECT id, username FROM public.\"User\" WHERE \"discordId\" IS NULL AND username IS NOT NULL LIMIT 10;"</code></pre>
                                        <button onclick="copyToClipboard(this.previousElementSibling.textContent)" class="copy-btn absolute top-2 right-2 bg-blue-600 text-white px-3 py-1 rounded text-sm hover:bg-blue-700">
                                            Copy
                                        </button>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </section>

                <!-- Disable Whitelist -->
                <section id="disable-whitelist" class="mb-12">
                    <h2 class="text-2xl font-semibold text-white mb-4">3. Disable CAD Whitelist</h2>
                    <div class="bg-gray-800 p-6 rounded-lg border border-gray-700">
                        <div class="space-y-4">
                            <div>
                                <h4 class="text-white font-semibold mb-2">Check current whitelist status</h4>
                                <div class="code-block">
                                    <div class="bg-gray-900 rounded-lg p-4 relative">
                                        <pre class="text-blue-400 text-sm overflow-x-auto"><code>psql -c "SELECT id, name, whitelisted FROM public.\"cad\";"</code></pre>
                                        <button onclick="copyToClipboard(this.previousElementSibling.textContent)" class="copy-btn absolute top-2 right-2 bg-blue-600 text-white px-3 py-1 rounded text-sm hover:bg-blue-700">
                                            Copy
                                        </button>
                                    </div>
                                </div>
                            </div>
                            
                            <div>
                                <h4 class="text-white font-semibold mb-2">Disable whitelist for all CADs</h4>
                                <div class="code-block">
                                    <div class="bg-gray-900 rounded-lg p-4 relative">
                                        <pre class="text-blue-400 text-sm overflow-x-auto"><code>psql -c "UPDATE public.\"cad\" SET whitelisted = false;"</code></pre>
                                        <button onclick="copyToClipboard(this.previousElementSibling.textContent)" class="copy-btn absolute top-2 right-2 bg-blue-600 text-white px-3 py-1 rounded text-sm hover:bg-blue-700">
                                            Copy
                                        </button>
                                    </div>
                                </div>
                            </div>
                            
                            <div>
                                <h4 class="text-white font-semibold mb-2">Verify changes</h4>
                                <div class="code-block">
                                    <div class="bg-gray-900 rounded-lg p-4 relative">
                                        <pre class="text-blue-400 text-sm overflow-x-auto"><code>psql -c "SELECT id, name, whitelisted FROM public.\"cad\";"</code></pre>
                                        <button onclick="copyToClipboard(this.previousElementSibling.textContent)" class="copy-btn absolute top-2 right-2 bg-blue-600 text-white px-3 py-1 rounded text-sm hover:bg-blue-700">
                                            Copy
                                        </button>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </section>

                <!-- Login Features -->
                <section id="login-features" class="mb-12">
                    <h2 class="text-2xl font-semibold text-white mb-4">4. Manage Login Features</h2>
                    <div class="bg-gray-800 p-6 rounded-lg border border-gray-700">
                        <div class="space-y-6">
                            <div>
                                <h4 class="text-white font-semibold mb-2">Check current feature settings</h4>
                                <div class="code-block">
                                    <div class="bg-gray-900 rounded-lg p-4 relative">
                                        <pre class="text-blue-400 text-sm overflow-x-auto"><code>psql -c "SELECT feature, \"isEnabled\" FROM public.\"CadFeature\" ORDER BY feature;"</code></pre>
                                        <button onclick="copyToClipboard(this.previousElementSibling.textContent)" class="copy-btn absolute top-2 right-2 bg-blue-600 text-white px-3 py-1 rounded text-sm hover:bg-blue-700">
                                            Copy
                                        </button>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
                                <div class="bg-gray-700 p-4 rounded-lg">
                                    <h5 class="text-green-400 font-semibold mb-2">Enable Regular Login</h5>
                                    <div class="code-block">
                                        <div class="bg-gray-900 rounded-lg p-3 relative">
                                            <pre class="text-blue-400 text-xs overflow-x-auto"><code>psql -c "UPDATE public.\"CadFeature\" SET \"isEnabled\" = true WHERE feature = 'ALLOW_REGULAR_LOGIN';"</code></pre>
                                            <button onclick="copyToClipboard(this.previousElementSibling.textContent)" class="copy-btn absolute top-1 right-1 bg-blue-600 text-white px-2 py-1 rounded text-xs hover:bg-blue-700">
                                                Copy
                                            </button>
                                        </div>
                                    </div>
                                </div>
                                
                                <div class="bg-gray-700 p-4 rounded-lg">
                                    <h5 class="text-yellow-400 font-semibold mb-2">Disable Discord Auth</h5>
                                    <div class="code-block">
                                        <div class="bg-gray-900 rounded-lg p-3 relative">
                                            <pre class="text-blue-400 text-xs overflow-x-auto"><code>psql -c "UPDATE public.\"CadFeature\" SET \"isEnabled\" = false WHERE feature = 'DISCORD_AUTH';"</code></pre>
                                            <button onclick="copyToClipboard(this.previousElementSibling.textContent)" class="copy-btn absolute top-1 right-1 bg-blue-600 text-white px-2 py-1 rounded text-xs hover:bg-blue-700">
                                                Copy
                                            </button>
                                        </div>
                                    </div>
                                </div>
                                
                                <div class="bg-gray-700 p-4 rounded-lg">
                                    <h5 class="text-blue-400 font-semibold mb-2">Toggle Steam OAuth</h5>
                                    <div class="code-block">
                                        <div class="bg-gray-900 rounded-lg p-3 relative">
                                            <pre class="text-blue-400 text-xs overflow-x-auto"><code>psql -c "UPDATE public.\"CadFeature\" SET \"isEnabled\" = true WHERE feature = 'STEAM_OAUTH';"</code></pre>
                                            <button onclick="copyToClipboard(this.previousElementSibling.textContent)" class="copy-btn absolute top-1 right-1 bg-blue-600 text-white px-2 py-1 rounded text-xs hover:bg-blue-700">
                                                Copy
                                            </button>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="bg-green-900/50 border border-green-700 p-4 rounded-lg">
                                <h4 class="text-green-300 font-semibold mb-2">🔧 Common Recovery Sequence</h4>
                                <p class="text-gray-300 mb-3">To restore normal username/password login:</p>
                                <div class="code-block">
                                    <div class="bg-gray-900 rounded-lg p-4 relative">
                                        <pre class="text-blue-400 text-sm overflow-x-auto"><code># Enable regular login and disable Discord authentication
psql -c "UPDATE public.\"CadFeature\" SET \"isEnabled\" = true WHERE feature = 'ALLOW_REGULAR_LOGIN';"
psql -c "UPDATE public.\"CadFeature\" SET \"isEnabled\" = false WHERE feature = 'DISCORD_AUTH';"</code></pre>
                                        <button onclick="copyToClipboard(this.previousElementSibling.textContent)" class="copy-btn absolute top-2 right-2 bg-blue-600 text-white px-3 py-1 rounded text-sm hover:bg-blue-700">
                                            Copy
                                        </button>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </section>

                <!-- Reset Passwords -->
                <section id="reset-passwords" class="mb-12">
                    <h2 class="text-2xl font-semibold text-white mb-4">5. Reset User Passwords</h2>
                    <div class="bg-gray-800 p-6 rounded-lg border border-gray-700">
                        <div class="space-y-4">
                            <div>
                                <h4 class="text-white font-semibold mb-2">Step 1: Enable pgcrypto extension</h4>
                                <div class="code-block">
                                    <div class="bg-gray-900 rounded-lg p-4 relative">
                                        <pre class="text-blue-400 text-sm overflow-x-auto"><code>psql -c "CREATE EXTENSION IF NOT EXISTS pgcrypto;"</code></pre>
                                        <button onclick="copyToClipboard(this.previousElementSibling.textContent)" class="copy-btn absolute top-2 right-2 bg-blue-600 text-white px-3 py-1 rounded text-sm hover:bg-blue-700">
                                            Copy
                                        </button>
                                    </div>
                                </div>
                            </div>
                            
                            <div>
                                <h4 class="text-white font-semibold mb-2">Step 2: List users with row numbers</h4>
                                <div class="code-block">
                                    <div class="bg-gray-900 rounded-lg p-4 relative">
                                        <pre class="text-blue-400 text-sm overflow-x-auto"><code>psql -c "SELECT row_number() OVER () AS num, username, id FROM public.\"User\" WHERE username IS NOT NULL ORDER BY username;"</code></pre>
                                        <button onclick="copyToClipboard(this.previousElementSibling.textContent)" class="copy-btn absolute top-2 right-2 bg-blue-600 text-white px-3 py-1 rounded text-sm hover:bg-blue-700">
                                            Copy
                                        </button>
                                    </div>
                                </div>
                            </div>
                            
                            <div>
                                <h4 class="text-white font-semibold mb-2">Step 3: Reset password by username</h4>
                                <div class="code-block">
                                    <div class="bg-gray-900 rounded-lg p-4 relative">
                                        <pre class="text-blue-400 text-sm overflow-x-auto"><code>psql -c "UPDATE public.\"User\" SET password = crypt('NEW_PASSWORD_HERE', gen_salt('bf')) WHERE username = 'USERNAME_HERE';"</code></pre>
                                        <button onclick="copyToClipboard(this.previousElementSibling.textContent)" class="copy-btn absolute top-2 right-2 bg-blue-600 text-white px-3 py-1 rounded text-sm hover:bg-blue-700">
                                            Copy
                                        </button>
                                    </div>
                                </div>
                            </div>
                            
                            <div>
                                <h4 class="text-white font-semibold mb-2">Alternative: Reset password by row number</h4>
                                <div class="code-block">
                                    <div class="bg-gray-900 rounded-lg p-4 relative">
                                        <pre class="text-blue-400 text-sm overflow-x-auto"><code>psql -c "UPDATE public.\"User\" SET password = crypt('NEW_PASSWORD_HERE', gen_salt('bf')) WHERE username = (SELECT username FROM (SELECT row_number() OVER () AS num, username FROM public.\"User\" WHERE username IS NOT NULL ORDER BY username) t WHERE num = ROW_NUMBER_HERE);"</code></pre>
                                        <button onclick="copyToClipboard(this.previousElementSibling.textContent)" class="copy-btn absolute top-2 right-2 bg-blue-600 text-white px-3 py-1 rounded text-sm hover:bg-blue-700">
                                            Copy
                                        </button>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="bg-yellow-900/50 border border-yellow-700 p-4 rounded-lg">
                                <h4 class="text-yellow-300 font-semibold mb-2">⚠️ Example Usage</h4>
                                <p class="text-gray-300 mb-2">Reset password for user "admin" to "newpassword123":</p>
                                <div class="code-block">
                                    <div class="bg-gray-900 rounded-lg p-4 relative">
                                        <pre class="text-blue-400 text-sm overflow-x-auto"><code>psql -c "UPDATE public.\"User\" SET password = crypt('newpassword123', gen_salt('bf')) WHERE username = 'admin';"</code></pre>
                                        <button onclick="copyToClipboard(this.previousElementSibling.textContent)" class="copy-btn absolute top-2 right-2 bg-blue-600 text-white px-3 py-1 rounded text-sm hover:bg-blue-700">
                                            Copy
                                        </button>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </section>

                <!-- Maintenance -->
                <section id="maintenance" class="mb-12">
                    <h2 class="text-2xl font-semibold text-white mb-4">6. Database Maintenance</h2>
                    <div class="bg-gray-800 p-6 rounded-lg border border-gray-700">
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                            <div>
                                <h4 class="text-white font-semibold mb-3">Vacuum and Analyze</h4>
                                <div class="space-y-3">
                                    <div class="code-block">
                                        <div class="bg-gray-900 rounded-lg p-4 relative">
                                            <pre class="text-blue-400 text-sm overflow-x-auto"><code># Full vacuum and analyze
psql -c "VACUUM ANALYZE;"</code></pre>
                                            <button onclick="copyToClipboard(this.previousElementSibling.textContent)" class="copy-btn absolute top-2 right-2 bg-blue-600 text-white px-3 py-1 rounded text-sm hover:bg-blue-700">
                                                Copy
                                            </button>
                                        </div>
                                    </div>
                                    
                                    <div class="code-block">
                                        <div class="bg-gray-900 rounded-lg p-4 relative">
                                            <pre class="text-blue-400 text-sm overflow-x-auto"><code># Update statistics only
psql -c "ANALYZE;"</code></pre>
                                            <button onclick="copyToClipboard(this.previousElementSibling.textContent)" class="copy-btn absolute top-2 right-2 bg-blue-600 text-white px-3 py-1 rounded text-sm hover:bg-blue-700">
                                                Copy
                                            </button>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            
                            <div>
                                <h4 class="text-white font-semibold mb-3">Database Information</h4>
                                <div class="space-y-3">
                                    <div class="code-block">
                                        <div class="bg-gray-900 rounded-lg p-4 relative">
                                            <pre class="text-blue-400 text-sm overflow-x-auto"><code># Check database size
psql -c "SELECT pg_size_pretty(pg_database_size(current_database()));"</code></pre>
                                            <button onclick="copyToClipboard(this.previousElementSibling.textContent)" class="copy-btn absolute top-2 right-2 bg-blue-600 text-white px-3 py-1 rounded text-sm hover:bg-blue-700">
                                                Copy
                                            </button>
                                        </div>
                                    </div>
                                    
                                    <div class="code-block">
                                        <div class="bg-gray-900 rounded-lg p-4 relative">
                                            <pre class="text-blue-400 text-sm overflow-x-auto"><code># Show active connections
psql -c "SELECT pid, usename, application_name, client_addr, state FROM pg_stat_activity WHERE state = 'active';"</code></pre>
                                            <button onclick="copyToClipboard(this.previousElementSibling.textContent)" class="copy-btn absolute top-2 right-2 bg-blue-600 text-white px-3 py-1 rounded text-sm hover:bg-blue-700">
                                                Copy
                                            </button>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            
                            <div>
                                <h4 class="text-white font-semibold mb-3">Table Statistics</h4>
                                <div class="code-block">
                                    <div class="bg-gray-900 rounded-lg p-4 relative">
                                        <pre class="text-blue-400 text-sm overflow-x-auto"><code># Check table sizes
psql -c "SELECT schemaname, tablename, pg_size_pretty(pg_total_relation_size(schemaname||'.'||tablename)) AS size FROM pg_tables WHERE schemaname = 'public' ORDER BY pg_total_relation_size(schemaname||'.'||tablename) DESC;"</code></pre>
                                        <button onclick="copyToClipboard(this.previousElementSibling.textContent)" class="copy-btn absolute top-2 right-2 bg-blue-600 text-white px-3 py-1 rounded text-sm hover:bg-blue-700">
                                            Copy
                                        </button>
                                    </div>
                                </div>
                            </div>
                            
                            <div>
                                <h4 class="text-white font-semibold mb-3">Integrity Check</h4>
                                <div class="code-block">
                                    <div class="bg-gray-900 rounded-lg p-4 relative">
                                        <pre class="text-blue-400 text-sm overflow-x-auto"><code># Basic integrity check
psql -c "SELECT schemaname, tablename, attname, n_distinct, correlation FROM pg_stats WHERE schemaname = 'public' LIMIT 10;"</code></pre>
                                        <button onclick="copyToClipboard(this.previousElementSibling.textContent)" class="copy-btn absolute top-2 right-2 bg-blue-600 text-white px-3 py-1 rounded text-sm hover:bg-blue-700">
                                            Copy
                                        </button>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </section>
            </div>

            <!-- Windows Commands -->
            <div id="windows-content" class="max-w-7xl mx-auto" style="display: none;">
                <div class="mb-8">
                    <h1 class="text-3xl font-bold text-white mb-4">SnailyCAD Manual Recovery - Windows</h1>
                    <p class="text-gray-300 text-lg">Step-by-step manual commands for Windows systems</p>
                </div>

                <!-- Database Setup -->
                <section class="mb-12">
                    <h2 class="text-2xl font-semibold text-white mb-4">Database Connection Setup</h2>
                    
                    <div class="space-y-6">
                        <div class="bg-gray-800 p-6 rounded-lg border border-gray-700">
                            <h3 class="text-xl font-semibold text-white mb-4">Step 1: Find PostgreSQL Installation</h3>
                            <div class="code-block">
                                <div class="bg-gray-900 rounded-lg p-4 relative">
                                    <pre class="text-green-400 text-sm overflow-x-auto"><code>REM Check for PostgreSQL installations
dir "C:\Program Files\PostgreSQL\" /AD

REM Find psql.exe in all versions
dir "C:\Program Files\PostgreSQL\*\bin\psql.exe" /S

REM Check if psql is in PATH
where psql</code></pre>
                                    <button onclick="copyToClipboard(this.previousElementSibling.textContent)" class="copy-btn absolute top-2 right-2 bg-blue-600 text-white px-3 py-1 rounded text-sm hover:bg-blue-700">
                                        Copy
                                    </button>
                                </div>
                            </div>
                        </div>

                        <div class="bg-gray-800 p-6 rounded-lg border border-gray-700">
                            <h3 class="text-xl font-semibold text-white mb-4">Step 2: Set Environment Variables</h3>
                            <div class="code-block">
                                <div class="bg-gray-900 rounded-lg p-4 relative">
                                    <pre class="text-green-400 text-sm overflow-x-auto"><code>REM Set database connection details
set PGHOST=localhost
set PGPORT=5432
set PGUSER=postgres
set PGDATABASE=snaily-cad-v4
set PGPASSWORD=your_password_here</code></pre>
                                    <button onclick="copyToClipboard(this.previousElementSibling.textContent)" class="copy-btn absolute top-2 right-2 bg-blue-600 text-white px-3 py-1 rounded text-sm hover:bg-blue-700">
                                        Copy
                                    </button>
                                </div>
                            </div>
                        </div>

                        <div class="bg-gray-800 p-6 rounded-lg border border-gray-700">
                            <h3 class="text-xl font-semibold text-white mb-4">Step 3: Test Database Connection</h3>
                            <div class="code-block">
                                <div class="bg-gray-900 rounded-lg p-4 relative">
                                    <pre class="text-green-400 text-sm overflow-x-auto"><code>REM Test connection (replace version number as needed)
"C:\Program Files\PostgreSQL\15\bin\psql.exe" -c "SELECT 1;"

REM Alternative with full connection string
"C:\Program Files\PostgreSQL\15\bin\psql.exe" -U postgres -d snaily-cad-v4 -h localhost -p 5432 -c "SELECT version();"</code></pre>
                                    <button onclick="copyToClipboard(this.previousElementSibling.textContent)" class="copy-btn absolute top-2 right-2 bg-blue-600 text-white px-3 py-1 rounded text-sm hover:bg-blue-700">
                                        Copy
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>
                </section>

                <!-- All Functions with Windows Commands -->
                <section class="mb-12">
                    <h2 class="text-2xl font-semibold text-white mb-4">Database Operations</h2>
                    
                    <div class="bg-yellow-900/50 border border-yellow-700 p-4 rounded-lg mb-6">
                        <h4 class="text-yellow-300 font-semibold mb-2">📝 Windows Note</h4>
                        <p class="text-gray-300">All SQL commands are identical to Unix/Linux. Only the psql executable path differs. Replace <code class="bg-gray-700 px-1 rounded">psql</code> with the full path to your PostgreSQL installation.</p>
                    </div>

                    <div class="space-y-6">
                        <!-- Template for Windows commands -->
                        <div class="bg-gray-800 p-6 rounded-lg border border-gray-700">
                            <h3 class="text-lg font-semibold text-white mb-3">Command Template</h3>
                            <p class="text-gray-300 mb-4">Replace <code class="bg-gray-700 px-2 py-1 rounded text-blue-300">VERSION</code> with your PostgreSQL version (10-16):</p>
                            <div class="code-block">
                                <div class="bg-gray-900 rounded-lg p-4 relative">
                                    <pre class="text-green-400 text-sm overflow-x-auto"><code>"C:\Program Files\PostgreSQL\VERSION\bin\psql.exe" -c "SQL_COMMAND_HERE"</code></pre>
                                    <button onclick="copyToClipboard(this.previousElementSibling.textContent)" class="copy-btn absolute top-2 right-2 bg-blue-600 text-white px-3 py-1 rounded text-sm hover:bg-blue-700">
                                        Copy
                                    </button>
                                </div>
                            </div>
                        </div>

                        <!-- List Users -->
                        <div class="bg-gray-800 p-6 rounded-lg border border-gray-700">
                            <h3 class="text-lg font-semibold text-white mb-3">1. List All Users</h3>
                            <div class="code-block">
                                <div class="bg-gray-900 rounded-lg p-4 relative">
                                    <pre class="text-blue-400 text-sm overflow-x-auto"><code>"C:\Program Files\PostgreSQL\15\bin\psql.exe" -c "SELECT row_number() OVER () AS num, id, username, \"discordId\" FROM public.\"User\" ORDER BY username;"</code></pre>
                                    <button onclick="copyToClipboard(this.previousElementSibling.textContent)" class="copy-btn absolute top-2 right-2 bg-blue-600 text-white px-3 py-1 rounded text-sm hover:bg-blue-700">
                                        Copy
                                    </button>
                                </div>
                            </div>
                        </div>

                        <!-- Unlink Discord -->
                        <div class="bg-gray-800 p-6 rounded-lg border border-gray-700">
                            <h3 class="text-lg font-semibold text-white mb-3">2. Unlink Discord ID</h3>
                            <div class="space-y-3">
                                <div class="code-block">
                                    <div class="bg-gray-900 rounded-lg p-4 relative">
                                        <pre class="text-blue-400 text-sm overflow-x-auto"><code>REM Find user by Discord ID
"C:\Program Files\PostgreSQL\15\bin\psql.exe" -c "SELECT id, username, \"discordId\" FROM public.\"User\" WHERE \"discordId\" = 'REPLACE_WITH_DISCORD_ID';"</code></pre>
                                        <button onclick="copyToClipboard(this.previousElementSibling.textContent)" class="copy-btn absolute top-2 right-2 bg-blue-600 text-white px-3 py-1 rounded text-sm hover:bg-blue-700">
                                            Copy
                                        </button>
                                    </div>
                                </div>
                                
                                <div class="code-block">
                                    <div class="bg-gray-900 rounded-lg p-4 relative">
                                        <pre class="text-blue-400 text-sm overflow-x-auto"><code>REM Unlink Discord ID
"C:\Program Files\PostgreSQL\15\bin\psql.exe" -c "UPDATE public.\"User\" SET \"discordId\" = NULL WHERE \"discordId\" = 'REPLACE_WITH_DISCORD_ID';"</code></pre>
                                        <button onclick="copyToClipboard(this.previousElementSibling.textContent)" class="copy-btn absolute top-2 right-2 bg-blue-600 text-white px-3 py-1 rounded text-sm hover:bg-blue-700">
                                            Copy
                                        </button>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Disable Whitelist -->
                        <div class="bg-gray-800 p-6 rounded-lg border border-gray-700">
                            <h3 class="text-lg font-semibold text-white mb-3">3. Disable CAD Whitelist</h3>
                            <div class="code-block">
                                <div class="bg-gray-900 rounded-lg p-4 relative">
                                    <pre class="text-blue-400 text-sm overflow-x-auto"><code>"C:\Program Files\PostgreSQL\15\bin\psql.exe" -c "UPDATE public.\"cad\" SET whitelisted = false;"</code></pre>
                                    <button onclick="copyToClipboard(this.previousElementSibling.textContent)" class="copy-btn absolute top-2 right-2 bg-blue-600 text-white px-3 py-1 rounded text-sm hover:bg-blue-700">
                                        Copy
                                    </button>
                                </div>
                            </div>
                        </div>

                        <!-- Login Features -->
                        <div class="bg-gray-800 p-6 rounded-lg border border-gray-700">
                            <h3 class="text-lg font-semibold text-white mb-3">4. Enable Regular Login & Disable Discord Auth</h3>
                            <div class="space-y-3">
                                <div class="code-block">
                                    <div class="bg-gray-900 rounded-lg p-4 relative">
                                        <pre class="text-blue-400 text-sm overflow-x-auto"><code>REM Enable username/password login
"C:\Program Files\PostgreSQL\15\bin\psql.exe" -c "UPDATE public.\"CadFeature\" SET \"isEnabled\" = true WHERE feature = 'ALLOW_REGULAR_LOGIN';"</code></pre>
                                        <button onclick="copyToClipboard(this.previousElementSibling.textContent)" class="copy-btn absolute top-2 right-2 bg-blue-600 text-white px-3 py-1 rounded text-sm hover:bg-blue-700">
                                            Copy
                                        </button>
                                    </div>
                                </div>
                                
                                <div class="code-block">
                                    <div class="bg-gray-900 rounded-lg p-4 relative">
                                        <pre class="text-blue-400 text-sm overflow-x-auto"><code>REM Disable Discord authentication
"C:\Program Files\PostgreSQL\15\bin\psql.exe" -c "UPDATE public.\"CadFeature\" SET \"isEnabled\" = false WHERE feature = 'DISCORD_AUTH';"</code></pre>
                                        <button onclick="copyToClipboard(this.previousElementSibling.textContent)" class="copy-btn absolute top-2 right-2 bg-blue-600 text-white px-3 py-1 rounded text-sm hover:bg-blue-700">
                                            Copy
                                        </button>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Reset Password -->
                        <div class="bg-gray-800 p-6 rounded-lg border border-gray-700">
                            <h3 class="text-lg font-semibold text-white mb-3">5. Reset User Password</h3>
                            <div class="space-y-3">
                                <div class="code-block">
                                    <div class="bg-gray-900 rounded-lg p-4 relative">
                                        <pre class="text-blue-400 text-sm overflow-x-auto"><code>REM Enable pgcrypto extension
"C:\Program Files\PostgreSQL\15\bin\psql.exe" -c "CREATE EXTENSION IF NOT EXISTS pgcrypto;"</code></pre>
                                        <button onclick="copyToClipboard(this.previousElementSibling.textContent)" class="copy-btn absolute top-2 right-2 bg-blue-600 text-white px-3 py-1 rounded text-sm hover:bg-blue-700">
                                            Copy
                                        </button>
                                    </div>
                                </div>
                                
                                <div class="code-block">
                                    <div class="bg-gray-900 rounded-lg p-4 relative">
                                        <pre class="text-blue-400 text-sm overflow-x-auto"><code>REM Reset password by username (replace USERNAME_HERE and NEW_PASSWORD_HERE)
"C:\Program Files\PostgreSQL\15\bin\psql.exe" -c "UPDATE public.\"User\" SET password = crypt('NEW_PASSWORD_HERE', gen_salt('bf')) WHERE username = 'USERNAME_HERE';"</code></pre>
                                        <button onclick="copyToClipboard(this.previousElementSibling.textContent)" class="copy-btn absolute top-2 right-2 bg-blue-600 text-white px-3 py-1 rounded text-sm hover:bg-blue-700">
                                            Copy
                                        </button>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Maintenance -->
                        <div class="bg-gray-800 p-6 rounded-lg border border-gray-700">
                            <h3 class="text-lg font-semibold text-white mb-3">6. Database Maintenance</h3>
                            <div class="space-y-3">
                                <div class="code-block">
                                    <div class="bg-gray-900 rounded-lg p-4 relative">
                                        <pre class="text-blue-400 text-sm overflow-x-auto"><code>REM Vacuum and analyze database
"C:\Program Files\PostgreSQL\15\bin\psql.exe" -c "VACUUM ANALYZE;"</code></pre>
                                        <button onclick="copyToClipboard(this.previousElementSibling.textContent)" class="copy-btn absolute top-2 right-2 bg-blue-600 text-white px-3 py-1 rounded text-sm hover:bg-blue-700">
                                            Copy
                                        </button>
                                    </div>
                                </div>
                                
                                <div class="code-block">
                                    <div class="bg-gray-900 rounded-lg p-4 relative">
                                        <pre class="text-blue-400 text-sm overflow-x-auto"><code>REM Check database size
"C:\Program Files\PostgreSQL\15\bin\psql.exe" -c "SELECT pg_size_pretty(pg_database_size(current_database()));"</code></pre>
                                        <button onclick="copyToClipboard(this.previousElementSibling.textContent)" class="copy-btn absolute top-2 right-2 bg-blue-600 text-white px-3 py-1 rounded text-sm hover:bg-blue-700">
                                            Copy
                                        </button>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </section>

                <!-- Windows Service Management -->
                <section class="mb-12">
                    <h2 class="text-2xl font-semibold text-white mb-4">PostgreSQL Service Management</h2>
                    <div class="bg-gray-800 p-6 rounded-lg border border-gray-700">
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                            <div>
                                <h4 class="text-white font-semibold mb-3">Service Status</h4>
                                <div class="code-block">
                                    <div class="bg-gray-900 rounded-lg p-4 relative">
                                        <pre class="text-green-400 text-sm overflow-x-auto"><code>REM Check PostgreSQL service status
sc query postgresql-x64-15

REM List all PostgreSQL services
sc query | findstr postgresql</code></pre>
                                        <button onclick="copyToClipboard(this.previousElementSibling.textContent)" class="copy-btn absolute top-2 right-2 bg-blue-600 text-white px-3 py-1 rounded text-sm hover:bg-blue-700">
                                            Copy
                                        </button>
                                    </div>
                                </div>
                            </div>
                            
                            <div>
                                <h4 class="text-white font-semibold mb-3">Service Control</h4>
                                <div class="code-block">
                                    <div class="bg-gray-900 rounded-lg p-4 relative">
                                        <pre class="text-green-400 text-sm overflow-x-auto"><code>REM Start PostgreSQL service
net start postgresql-x64-15

REM Stop PostgreSQL service
net stop postgresql-x64-15</code></pre>
                                        <button onclick="copyToClipboard(this.previousElementSibling.textContent)" class="copy-btn absolute top-2 right-2 bg-blue-600 text-white px-3 py-1 rounded text-sm hover:bg-blue-700">
                                            Copy
                                        </button>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </section>
            </div>
        </main>
    </div>

    <script>
        // Tab switching functionality
        function showPage(page) {
            const unixContent = document.getElementById('unix-content');
            const windowsContent = document.getElementById('windows-content');
            const unixTab = document.getElementById('unix-tab');
            const windowsTab = document.getElementById('windows-tab');
            
            if (page === 'unix') {
                unixContent.style.display = 'block';
                windowsContent.style.display = 'none';
                unixTab.classList.add('active', 'bg-blue-600', 'text-white');
                unixTab.classList.remove('text-gray-300', 'hover:text-white', 'hover:bg-gray-700');
                windowsTab.classList.remove('active', 'bg-blue-600', 'text-white');
                windowsTab.classList.add('text-gray-300', 'hover:text-white', 'hover:bg-gray-700');
            } else {
                unixContent.style.display = 'none';
                windowsContent.style.display = 'block';
                windowsTab.classList.add('active', 'bg-blue-600', 'text-white');
                windowsTab.classList.remove('text-gray-300', 'hover:text-white', 'hover:bg-gray-700');
                unixTab.classList.remove('active', 'bg-blue-600', 'text-white');
                unixTab.classList.add('text-gray-300', 'hover:text-white', 'hover:bg-gray-700');
            }
        }

        // Copy to clipboard functionality
        function copyToClipboard(text) {
            navigator.clipboard.writeText(text.trim()).then(function() {
                // Show success feedback
                const toast = document.createElement('div');
                toast.className = 'fixed top-4 right-4 bg-green-600 text-white px-4 py-2 rounded-lg shadow-lg z-50';
                toast.textContent = 'Copied to clipboard!';
                document.body.appendChild(toast);
                
                setTimeout(() => {
                    toast.remove();
                }, 2000);
            }).catch(function(err) {
                console.error('Could not copy text: ', err);
                // Fallback for older browsers
                const textArea = document.createElement('textarea');
                textArea.value = text.trim();
                document.body.appendChild(textArea);
                textArea.select();
                try {
                    document.execCommand('copy');
                    const toast = document.createElement('div');
                    toast.className = 'fixed top-4 right-4 bg-green-600 text-white px-4 py-2 rounded-lg shadow-lg z-50';
                    toast.textContent = 'Copied to clipboard!';
                    document.body.appendChild(toast);
                    
                    setTimeout(() => {
                        toast.remove();
                    }, 2000);
                } catch (err) {
                    console.error('Fallback copy failed: ', err);
                }
                document.body.removeChild(textArea);
            });
        }

        // Sidebar navigation
        document.addEventListener('DOMContentLoaded', function() {
            const links = document.querySelectorAll('.sidebar-link');
            
            links.forEach(link => {
                link.addEventListener('click', function(e) {
                    e.preventDefault();
                    const target = document.querySelector(this.getAttribute('href'));
                    if (target) {
                        target.scrollIntoView({ behavior: 'smooth', block: 'start' });
                    }
                });
            });

            // Scrollspy functionality
            function updateScrollspy() {
                const sections = document.querySelectorAll('section[id]');
                const scrollPosition = window.scrollY + 100;

                sections.forEach(section => {
                    const top = section.offsetTop;
                    const bottom = top + section.offsetHeight;
                    const link = document.querySelector(`.sidebar-link[href="#${section.id}"]`);
                    
                    if (link) {
                        if (scrollPosition >= top && scrollPosition < bottom) {
                            link.classList.add('scrollspy-active');
                        } else {
                            link.classList.remove('scrollspy-active');
                        }
                    }
                });
            }

            window.addEventListener('scroll', updateScrollspy);
            updateScrollspy(); // Initial call
        });
    </script>
</body>
</html>
